<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Islamic Daily Tracker</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
      }

      .header {
        text-align: center;
        color: white;
        margin-bottom: 30px;
      }

      .header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .tabs {
        display: flex;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        margin-bottom: 20px;
        overflow: hidden;
      }

      .tab-button {
        flex: 1;
        padding: 15px 20px;
        background: transparent;
        border: none;
        color: white;
        cursor: pointer;
        font-size: 1em;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .tab-button.active {
        background: rgba(255, 255, 255, 0.2);
        color: #fff;
      }

      .tab-button:hover {
        background: rgba(255, 255, 255, 0.15);
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      .date-display {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 15px;
        margin-bottom: 20px;
        color: white;
        text-align: center;
      }

      .prayers-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .prayer-card {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        backdrop-filter: blur(4px);
        border: 1px solid rgba(255, 255, 255, 0.18);
        transition: all 0.3s ease;
      }

      .prayer-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 40px rgba(31, 38, 135, 0.5);
      }

      .prayer-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .prayer-name {
        font-size: 1.4em;
        font-weight: bold;
        color: #4c63d2;
      }

      .prayer-time {
        font-size: 1.1em;
        color: #666;
      }

      .prayer-status {
        display: flex;
        gap: 10px;
        margin-bottom: 15px;
      }

      .status-btn {
        flex: 1;
        padding: 10px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .status-btn.prayed {
        background: #4caf50;
        color: white;
      }

      .status-btn.missed {
        background: #f44336;
        color: white;
      }

      .status-btn:not(.prayed):not(.missed) {
        background: #f0f0f0;
        color: #666;
      }

      .status-btn.pending-reset {
        background: #ccc;
        color: #333;
      }

      .status-btn:hover {
        transform: scale(1.05);
      }

      .missed-count {
        text-align: center;
        color: #f44336;
        font-weight: bold;
        margin-top: 10px;
      }

      .section {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 20px;
        box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
      }

      .section-title {
        font-size: 1.5em;
        color: #4c63d2;
        margin-bottom: 20px;
        text-align: center;
      }

      .missed-prayer-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px;
        background: #fff5f5;
        border-radius: 8px;
        margin-bottom: 10px;
        border-left: 4px solid #f44336;
      }

      .archive-date-header {
        font-size: 1.2em;
        color: #4c63d2;
        padding: 10px 0;
        margin-top: 20px;
        border-bottom: 1px solid #ddd;
      }

      .make-up-btn {
        background: #4caf50;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .make-up-btn:hover {
        background: #45a049;
        transform: scale(1.05);
      }

      .stats-section {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
      }

      .stat-card {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 10px;
        padding: 15px;
        text-align: center;
        box-shadow: 0 4px 15px rgba(31, 38, 135, 0.2);
      }

      .stat-value {
        font-size: 2em;
        font-weight: bold;
        color: #4c63d2;
      }

      .stat-label {
        color: #666;
        margin-top: 5px;
      }

      .calendar {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 2px;
        margin-bottom: 20px;
      }

      .calendar-header {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 2px;
        margin-bottom: 10px;
      }

      .calendar-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .nav-btn {
        background: #4c63d2;
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
      }

      .nav-btn:hover {
        background: #3d52b8;
      }

      .day-header {
        background: #4c63d2;
        color: white;
        padding: 10px;
        text-align: center;
        font-weight: bold;
      }

      .calendar-day {
        background: white;
        border: 1px solid #ddd;
        padding: 10px;
        text-align: center;
        cursor: pointer;
        min-height: 50px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        transition: all 0.3s ease;
      }

      .calendar-day:hover {
        background: #f0f8ff;
      }

      .calendar-day.other-month {
        color: #ccc;
        background: #f9f9f9;
      }

      .calendar-day.has-missed {
        background: #ffe6e6;
        border-color: #f44336;
      }

      .calendar-day.today {
        background: #e8f5e8;
        border-color: #4caf50;
      }

      .day-number {
        font-weight: bold;
        margin-bottom: 2px;
      }

      .missed-indicator {
        font-size: 0.8em;
        color: #f44336;
      }

      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
      }

      .modal-content {
        background: white;
        margin: 10% auto;
        padding: 20px;
        border-radius: 15px;
        max-width: 500px;
        max-height: 80vh;
        overflow-y: auto;
      }

      .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
      }

      .close:hover {
        color: #000;
      }

      .prayer-checklist {
        display: grid;
        gap: 10px;
        margin-top: 15px;
      }

      .prayer-check-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        background: #f9f9f9;
        border-radius: 5px;
      }

      .prayer-check-item select {
        padding: 5px 10px;
        border-radius: 5px;
        border: 1px solid #ddd;
      }

      .azkar-section {
        margin-bottom: 30px;
      }

      .azkar-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
      }

      .azkar-card {
        background: white;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }

      .azkar-card.prayed {
        border: 3px solid #4caf50;
      }

      .azkar-title {
        font-size: 1.2em;
        font-weight: bold;
        color: #4c63d2;
        margin-bottom: 15px;
        text-align: center;
      }

      .azkar-text {
        font-size: 1.1em;
        line-height: 1.8;
        text-align: right;
        direction: rtl;
        margin-bottom: 10px;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 8px;
        border-right: 4px solid #4c63d2;
      }

      .azkar-translation {
        font-size: 0.95em;
        color: #666;
        font-style: italic;
        margin-bottom: 15px;
      }

      .azkar-note {
        font-size: 0.9em;
        color: #4caf50;
        font-weight: bold;
        margin-bottom: 15px;
        text-align: center;
        padding: 8px;
        background-color: #f0fff0;
        border-radius: 5px;
      }

      .azkar-counter {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 15px;
      }

      .counter-btn {
        background: #4c63d2;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 25px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .counter-btn.prayed {
        background: #4caf50;
      }

      .counter-btn:hover {
        background: #3d52b8;
        transform: scale(1.05);
      }

      .counter-display {
        font-size: 1.2em;
        font-weight: bold;
        color: #4c63d2;
      }

      .istighfar-counter {
        text-align: center;
        background: white;
        border-radius: 15px;
        padding: 30px;
        margin-bottom: 20px;
      }

      .istighfar-text {
        font-size: 1.5em;
        line-height: 1.8;
        text-align: center;
        direction: rtl;
        margin-bottom: 20px;
        padding: 20px;
        background: #f8f9fa;
        border: 2px solid #4c63d2;
        border-radius: 10px;
      }

      .big-counter {
        font-size: 3em;
        font-weight: bold;
        color: #4c63d2;
        margin: 20px 0;
      }

      .big-counter-btn {
        background: #4c63d2;
        color: white;
        border: none;
        padding: 20px 40px;
        border-radius: 50px;
        cursor: pointer;
        font-size: 1.2em;
        font-weight: bold;
        transition: all 0.3s ease;
        margin: 10px;
      }

      .big-counter-btn:hover {
        background: #3d52b8;
        transform: scale(1.05);
      }

      .reset-btn {
        background: #ff9800;
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        font-size: 1em;
        transition: all 0.3s ease;
        margin: 5px;
      }

      .reset-btn:hover {
        background: #f57c00;
        transform: scale(1.05);
      }

      .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #4caf50;
        color: white;
        padding: 15px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        transform: translateX(400px);
        transition: transform 0.3s ease;
      }

      .notification.show {
        transform: translateX(0);
      }

      @media (max-width: 768px) {
        .container {
          padding: 10px;
        }

        .header h1 {
          font-size: 2em;
        }

        .prayers-grid,
        .azkar-grid {
          grid-template-columns: 1fr;
        }

        .tabs {
          flex-wrap: wrap;
        }

        .tab-button {
          flex: 1 1 45%;
        }

        .calendar {
          font-size: 0.9em;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üïå Daily Salah Tracker</h1>
        <p>Track your prayers, dhikr, and daily Islamic practices</p>
      </div>

      <div class="tabs">
        <button class="tab-button active" onclick="switchTab('salah')">
          üìø Today's Salah
        </button>
        <button class="tab-button" onclick="switchTab('calendar')">
          üìÖ Calendar
        </button>
        <button class="tab-button" onclick="switchTab('qada')">
          üìö Qada Archive
        </button>
        <button class="tab-button" onclick="switchTab('istighfar')">
          ü§≤ Istighfar
        </button>
        <button class="tab-button" onclick="switchTab('azkar')">
          üìñ Daily Azkar
        </button>
      </div>

      <div id="salah-tab" class="tab-content active">
        <div class="date-display">
          <h2 id="currentDate"></h2>
        </div>

        <div class="stats-section">
          <div class="stat-card">
            <div class="stat-value" id="todayPrayed">0</div>
            <div class="stat-label">Prayed Today</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="totalMissed">0</div>
            <div class="stat-label">Total Missed</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="weeklyPercentage">0%</div>
            <div class="stat-label">This Week</div>
          </div>
        </div>

        <div class="prayers-grid" id="prayersGrid"></div>

        <div class="section">
          <h2 class="section-title">
            Missed Prayers to Make Up (Today's Archive)
          </h2>
          <div id="missedPrayersList">
            <p style="text-align: center; color: #666">
              No missed prayers - Alhamdulillah! üéâ
            </p>
          </div>
        </div>

        <div style="text-align: center">
          <button class="reset-btn" onclick="resetDay()">
            Reset Today's Practices
          </button>
        </div>
      </div>

      <div id="calendar-tab" class="tab-content">
        <div class="section">
          <h2 class="section-title">
            Prayer Calendar - Add Previous Missed Prayers
          </h2>
          <div class="calendar-nav">
            <button class="nav-btn" onclick="changeMonth(-1)">
              ‚Üê Previous
            </button>
            <h3 id="currentMonth"></h3>
            <button class="nav-btn" onclick="changeMonth(1)">Next ‚Üí</button>
          </div>

          <div class="calendar-header">
            <div class="day-header">Sun</div>
            <div class="day-header">Mon</div>
            <div class="day-header">Tue</div>
            <div class="day-header">Wed</div>
            <div class="day-header">Thu</div>
            <div class="day-header">Fri</div>
            <div class="day-header">Sat</div>
          </div>

          <div class="calendar" id="calendar"></div>
        </div>
      </div>

      <!-- NEW Qada Archive Tab -->
      <div id="qada-tab" class="tab-content">
        <div class="section">
          <h2 class="section-title">
            üìö Qada Prayer Archive (Total Missed:
            <span id="totalMissedArchive">0</span>)
          </h2>
          <p style="color: #666; text-align: center; margin-bottom: 20px">
            Use the "Made Up (Remove)" button to permanently remove a prayer
            from the Qada debt list.
          </p>
          <div id="qadaArchiveList">
            <p style="text-align: center; color: #666">
              The full history of missed prayers will appear here.
            </p>
          </div>
        </div>
      </div>

      <div id="istighfar-tab" class="tab-content">
        <div class="istighfar-counter section">
          <h2 class="section-title">Daily Istighfar Counter</h2>
          <div class="istighfar-text">
            ÿ£Ÿéÿ≥Ÿíÿ™Ÿéÿ∫ŸíŸÅŸêÿ±Ÿè ÿßŸÑŸÑŸéŸëŸáŸé ÿßŸÑŸíÿπŸéÿ∏ŸêŸäŸÖŸé ÿßŸÑŸéŸëÿ∞ŸêŸä ŸÑŸéÿß ÿ•ŸêŸÑŸéŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß ŸáŸèŸàŸé
            ÿßŸÑŸíÿ≠ŸéŸäŸèŸë ÿßŸÑŸíŸÇŸéŸäŸè÷ºŸàŸÖŸè ŸàŸéÿ£Ÿéÿ™ŸèŸàÿ®Ÿè ÿ•ŸêŸÑŸéŸäŸíŸáŸê
          </div>
          <p style="font-style: italic; color: #666; margin-bottom: 20px">
            "I seek forgiveness from Allah the Mighty, whom there is no god but
            He, the Living, the Eternal, and I repent to Him"
          </p>

          <div class="big-counter" id="istighfarCount">0</div>
          <div>
            <button class="big-counter-btn" onclick="incrementIstighfar()">
              Say Istighfar
            </button>
            <button class="reset-btn" onclick="resetIstighfar()">
              Reset Count
            </button>
          </div>
          <p style="margin-top: 15px; color: #666">
            Today's Goal:
            <span style="color: #4c63d2; font-weight: bold">100 times</span>
          </p>
        </div>
      </div>

      <div id="azkar-tab" class="tab-content">
        <div class="azkar-section">
          <h2 class="section-title">Morning Azkar (ÿ£ÿ∞ŸÉÿßÿ± ÿßŸÑÿµÿ®ÿßÿ≠)</h2>
          <div class="azkar-grid" id="morningAzkar"></div>
        </div>

        <div class="azkar-section">
          <h2 class="section-title">Evening Azkar (ÿ£ÿ∞ŸÉÿßÿ± ÿßŸÑŸÖÿ≥ÿßÿ°)</h2>
          <div class="azkar-grid" id="eveningAzkar"></div>
        </div>
      </div>
    </div>

    <div id="dayModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeDayModal()">&times;</span>
        <h2 id="modalDate"></h2>
        <p>Select missed/prayed status for this day:</p>
        <div class="prayer-checklist" id="modalPrayers"></div>
        <div style="text-align: center; margin-top: 20px">
          <button class="counter-btn" onclick="saveDayPrayers()">
            Save Changes
          </button>
        </div>
      </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
      const prayers = [
        { name: "Fajr", time: "05:30" },
        { name: "Dhuhr", time: "12:30" },
        { name: "Asr", time: "15:45" },
        { name: "Maghrib", time: "18:15" },
        { name: "Isha", time: "19:45" },
      ];

      // --- UPDATED MORNING AZKAR DATA ---
      const morningAzkarData = [
        {
          id: "m_a1",
          name: "Ayat al-Kursi",
          arabic:
            "ÿßŸÑŸÑŸéŸëŸáŸè ŸÑŸéÿß ÿ•ŸêŸÑŸéŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß ŸáŸèŸàŸé ÿßŸÑŸíÿ≠ŸéŸäŸèŸë ÿßŸÑŸíŸÇŸéŸäŸèŸëŸàŸÖŸè €ö ŸÑŸéÿß ÿ™Ÿéÿ£ŸíÿÆŸèÿ∞ŸèŸáŸè ÿ≥ŸêŸÜŸéÿ©Ÿå ŸàŸéŸÑŸéÿß ŸÜŸéŸàŸíŸÖŸå €ö ŸÑŸéŸáŸè ŸÖŸéÿß ŸÅŸêŸä ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßŸàŸéÿßÿ™Ÿê ŸàŸéŸÖŸéÿß ŸÅŸêŸä ÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿê €ó ŸÖŸéŸÜŸí ÿ∞Ÿéÿß ÿßŸÑŸéŸëÿ∞ŸêŸä ŸäŸéÿ¥ŸíŸÅŸéÿπŸè ÿπŸêŸÜŸíÿØŸéŸáŸè ÿ•ŸêŸÑŸéŸëÿß ÿ®Ÿêÿ•Ÿêÿ∞ŸíŸÜŸêŸáŸê €ö ŸäŸéÿπŸíŸÑŸéŸÖŸè ŸÖŸéÿß ÿ®ŸéŸäŸíŸÜŸé ÿ£ŸéŸäŸíÿØŸêŸäŸáŸêŸÖŸí ŸàŸéŸÖŸéÿß ÿÆŸéŸÑŸíŸÅŸéŸáŸèŸÖŸí ŸàŸéŸÑŸéÿß ŸäŸèÿ≠ŸêŸäÿ∑ŸèŸàŸÜŸé ÿ®Ÿêÿ¥ŸéŸäŸíÿ°Ÿç ŸÖŸêŸÜŸí ÿπŸêŸÑŸíŸÖŸêŸáŸê ÿ•ŸêŸÑŸéŸëÿß ÿ®ŸêŸÖŸéÿß ÿ¥Ÿéÿßÿ°Ÿé €ö ŸàŸéÿ≥ŸêÿπŸé ŸÉŸèÿ±Ÿíÿ≥ŸêŸäŸèŸëŸáŸè ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßŸàŸéÿßÿ™Ÿê ŸàŸéÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿé €ñ ŸàŸéŸÑŸéÿß ŸäŸéÿ¶ŸèŸàÿØŸèŸáŸè ÿ≠ŸêŸÅŸíÿ∏ŸèŸáŸèŸÖŸéÿß €ö ŸàŸéŸáŸèŸàŸé ÿßŸÑŸíÿπŸéŸÑŸêŸäŸèŸë ÿßŸÑŸíÿπŸéÿ∏ŸêŸäŸÖŸè",
          translation:
            "AllƒÅhu lƒÅ ilƒÅha illƒÅ huwa al-·∏•ayyul-qayy≈´m... (Surah Al-Baqarah, 2:255)",
          note: "Recite 1 time. Protection from morning until evening. (Sahih Muslim)",
          goal: 1,
        },
        {
          id: "m_a2",
          name: "Surah IkhlƒÅs, Falaq, NƒÅs",
          arabic:
            "ŸÇŸèŸÑŸí ŸáŸèŸàŸé ÿßŸÑŸÑŸéŸëŸáŸè ÿ£Ÿéÿ≠ŸéÿØŸå / ŸÇŸèŸÑŸí ÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®Ÿêÿ±Ÿéÿ®ŸêŸë ÿßŸÑŸíŸÅŸéŸÑŸéŸÇŸê / ŸÇŸèŸÑŸí ÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®Ÿêÿ±Ÿéÿ®ŸêŸë ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿê",
          translation:
            "Recite the last three Surahs (Al-IkhlƒÅs, Al-Falaq, and An-NƒÅs)",
          note: "Recite 3 times each. Complete protection from evil. (Tirmidhi)",
          goal: 3,
        },
        {
          id: "m_a3",
          name: "Tasbƒ´h of Forgiveness",
          arabic: "ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸé ÿßŸÑŸÑŸéŸëŸáŸê ŸàŸéÿ®Ÿêÿ≠ŸéŸÖŸíÿØŸêŸáŸê",
          translation: "Sub·∏•ƒÅnallƒÅhi wa bi·∏•amdih.",
          note: "Recite 100 times. All sins forgiven even if like the foam of the sea. (Sahih Bukhari)",
          goal: 100,
        },
        {
          id: "m_a4",
          name: "Kalimat al-Taw·∏•ƒ´d",
          arabic:
            "ŸÑŸéÿß ÿ•ŸêŸÑŸéŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß ÿßŸÑŸÑŸéŸëŸáŸè ŸàŸéÿ≠ŸíÿØŸéŸáŸè ŸÑŸéÿß ÿ¥Ÿéÿ±ŸêŸäŸÉŸé ŸÑŸéŸáŸèÿå ŸÑŸéŸáŸè ÿßŸÑŸíŸÖŸèŸÑŸíŸÉŸè ŸàŸéŸÑŸéŸáŸè ÿßŸÑŸíÿ≠ŸéŸÖŸíÿØŸèÿå ŸàŸéŸáŸèŸàŸé ÿπŸéŸÑŸéŸâ ŸÉŸèŸÑŸêŸë ÿ¥ŸéŸäŸíÿ°Ÿç ŸÇŸéÿØŸêŸäÿ±Ÿå",
          translation:
            "LƒÅ ilƒÅha illallƒÅhu wa·∏•dahu lƒÅ sharƒ´ka lahu... (100 times)",
          note: "Recite 100 times. Reward like freeing ten slaves; protection from shay·π≠ƒÅn all day. (Bukhari, Muslim)",
          goal: 100,
        },
        {
          id: "m_a5",
          name: "Morning Declaration of Faith",
          arabic:
            "ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸêŸëŸä ÿ£ŸéÿµŸíÿ®Ÿéÿ≠Ÿíÿ™Ÿè ÿ£Ÿèÿ¥ŸíŸáŸêÿØŸèŸÉŸéÿå ŸàŸéÿ£Ÿèÿ¥ŸíŸáŸêÿØŸè ÿ≠ŸéŸÖŸéŸÑŸéÿ©Ÿé ÿπŸéÿ±Ÿíÿ¥ŸêŸÉŸéÿå ŸàŸéŸÖŸéŸÑŸéÿßÿ¶ŸêŸÉŸéÿ™ŸéŸÉŸéÿå ŸàŸéÿ¨ŸéŸÖŸêŸäÿπŸé ÿÆŸéŸÑŸíŸÇŸêŸÉŸéÿå ÿ£ŸéŸÜŸéŸëŸÉŸé ÿ£ŸéŸÜŸíÿ™Ÿé ÿßŸÑŸÑŸéŸëŸáŸèÿå ŸÑŸéÿß ÿ•ŸêŸÑŸéŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß ÿ£ŸéŸÜŸíÿ™Ÿé ŸàŸéÿ≠ŸíÿØŸéŸÉŸé ŸÑŸéÿß ÿ¥Ÿéÿ±ŸêŸäŸÉŸé ŸÑŸéŸÉŸéÿå ŸàŸéÿ£ŸéŸÜŸéŸë ŸÖŸèÿ≠ŸéŸÖŸéŸëÿØŸãÿß ÿπŸéÿ®ŸíÿØŸèŸÉŸé ŸàŸéÿ±Ÿéÿ≥ŸèŸàŸÑŸèŸÉŸé",
          translation: "AllƒÅhumma innƒ´ a·π£ba·∏•tu ush-hiduka... (4 times)",
          note: "Recite 4 times. Declaration of faith and protection. (Abu Dawood)",
          goal: 4,
        },
        {
          id: "m_a6",
          name: "Dua of Gratitude",
          arabic:
            "ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ŸÖŸéÿß ÿ£ŸéÿµŸíÿ®Ÿéÿ≠Ÿé ÿ®ŸêŸä ŸÖŸêŸÜŸí ŸÜŸêÿπŸíŸÖŸéÿ©Ÿç ŸÅŸéŸÖŸêŸÜŸíŸÉŸé ŸàŸéÿ≠ŸíÿØŸéŸÉŸé ŸÑŸéÿß ÿ¥Ÿéÿ±ŸêŸäŸÉŸé ŸÑŸéŸÉŸéÿå ŸÅŸéŸÑŸéŸÉŸé ÿßŸÑŸíÿ≠ŸéŸÖŸíÿØŸè ŸàŸéŸÑŸéŸÉŸé ÿßŸÑÿ¥ŸèŸëŸÉŸíÿ±Ÿè",
          translation:
            "AllƒÅhumma mƒÅ a·π£ba·∏•a bƒ´ min ni ømatin fa minka... (Recite once)",
          note: "Recite 1 time. Expresses gratitude for all blessings. (Abu Dawood)",
          goal: 1,
        },
        {
          id: "m_a7",
          name: "Dua for Relief from Worry",
          arabic:
            "ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸêŸëŸä ÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®ŸêŸÉŸé ŸÖŸêŸÜŸé ÿßŸÑŸíŸáŸéŸÖŸêŸë ŸàŸéÿßŸÑŸíÿ≠Ÿéÿ≤ŸéŸÜŸêÿå ŸàŸéÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®ŸêŸÉŸé ŸÖŸêŸÜŸé ÿßŸÑŸíÿπŸéÿ¨Ÿíÿ≤Ÿê ŸàŸéÿßŸÑŸíŸÉŸéÿ≥ŸéŸÑŸêÿå ŸàŸéÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®ŸêŸÉŸé ŸÖŸêŸÜŸé ÿßŸÑŸíÿ¨Ÿèÿ®ŸíŸÜŸê ŸàŸéÿßŸÑŸíÿ®ŸèÿÆŸíŸÑŸêÿå ŸàŸéÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®ŸêŸÉŸé ŸÖŸêŸÜŸí ÿ∫ŸéŸÑŸéÿ®Ÿéÿ©Ÿê ÿßŸÑÿØŸéŸëŸäŸíŸÜŸê ŸàŸéŸÇŸéŸáŸíÿ±Ÿê ÿßŸÑÿ±ŸêŸëÿ¨ŸéÿßŸÑŸê",
          translation:
            "AllƒÅhumma innƒ´ a ø≈´dhu bika min al-hammi wal-·∏•azan... (Recite once)",
          note: "Recite 1 time. Protection from sadness, debt, and oppression. (Bukhari)",
          goal: 1,
        },
        {
          id: "m_a8",
          name: "Surah Al-Baqarah End",
          arabic:
            "ÿ¢ŸÖŸéŸÜŸé ÿßŸÑÿ±ŸéŸëÿ≥ŸèŸàŸÑŸè ÿ®ŸêŸÖŸéÿß ÿ£ŸèŸÜÿ≤ŸêŸÑŸé ÿ•ŸêŸÑŸéŸäŸíŸáŸê ŸÖŸêŸÜŸí ÿ±Ÿéÿ®ŸêŸëŸáŸê... (ÿßŸÑÿ¢Ÿäÿ™ÿßŸÜ ÿßŸÑÿ£ÿÆŸäÿ±ÿ™ÿßŸÜ)",
          translation:
            "ƒÄmana-r-ras≈´lu bimƒÅ unzila ilayhi... (Last two verses of Surah 2)",
          note: "Recite 1 time. Sufficient protection for the whole day and night. (Bukhari, Muslim)",
          goal: 1,
        },
        {
          id: "m_a9",
          name: "Dua for Health and Provision",
          arabic:
            "ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿπŸéÿßŸÅŸêŸÜŸêŸä ŸÅŸêŸä ÿ®ŸéÿØŸéŸÜŸêŸäÿå ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿπŸéÿßŸÅŸêŸÜŸêŸä ŸÅŸêŸä ÿ≥ŸéŸÖŸíÿπŸêŸäÿå ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿπŸéÿßŸÅŸêŸÜŸêŸä ŸÅŸêŸä ÿ®ŸéÿµŸéÿ±ŸêŸäÿå ŸÑŸéÿß ÿ•ŸêŸÑŸéŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß ÿ£ŸéŸÜŸíÿ™Ÿé. ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸêŸëŸä ÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®ŸêŸÉŸé ŸÖŸêŸÜŸé ÿßŸÑŸíŸÉŸèŸÅŸíÿ±Ÿê ŸàŸéÿßŸÑŸíŸÅŸéŸÇŸíÿ±Ÿêÿå ŸàŸéÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®ŸêŸÉŸé ŸÖŸêŸÜŸí ÿπŸéÿ∞Ÿéÿßÿ®Ÿê ÿßŸÑŸíŸÇŸéÿ®Ÿíÿ±Ÿêÿå ŸÑŸéÿß ÿ•ŸêŸÑŸéŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß ÿ£ŸéŸÜŸíÿ™Ÿé",
          translation: "AllƒÅhumma  øƒÅfinƒ´ fƒ´ badanƒ´... (Recite 3 times)",
          note: "Recite 3 times. For health, protection, and sustenance. (Abu Dawood)",
          goal: 3,
        },
        {
          id: "m_a10",
          name: "·∏§asbiyallƒÅhu (Sufficiency)",
          arabic:
            "ÿ≠Ÿéÿ≥Ÿíÿ®ŸêŸäŸé ÿßŸÑŸÑŸéŸëŸáŸè ŸÑŸéÿß ÿ•ŸêŸÑŸéŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß ŸáŸèŸàŸéÿå ÿπŸéŸÑŸéŸäŸíŸáŸê ÿ™ŸéŸàŸéŸÉŸéŸëŸÑŸíÿ™Ÿèÿå ŸàŸéŸáŸèŸàŸé ÿ±Ÿéÿ®ŸèŸë ÿßŸÑŸíÿπŸéÿ±Ÿíÿ¥Ÿê ÿßŸÑŸíÿπŸéÿ∏ŸêŸäŸÖŸê",
          translation: "·∏§asbiyallƒÅhu lƒÅ ilƒÅha illƒÅ huwa... (Recite 7 times)",
          note: "Recite 7 times. Allah will suffice him for whatever concerns him of the matter of this world and the Hereafter. (Abu Dawood)",
          goal: 7,
        },
        {
          id: "m_a11",
          name: "AstaghfirullƒÅh (General)",
          arabic: "ÿ£Ÿéÿ≥Ÿíÿ™Ÿéÿ∫ŸíŸÅŸêÿ±Ÿè ÿßŸÑŸÑŸéŸëŸáŸé ŸàŸéÿ£Ÿéÿ™ŸèŸàÿ®Ÿè ÿ•ŸêŸÑŸéŸäŸíŸáŸê",
          translation: "AstaghfirullƒÅh wa at≈´bu ilayh. (Recite 100 times)",
          note: "Recite 100 times. Seeking general forgiveness.",
          goal: 100,
        },
      ];

      // --- UPDATED EVENING AZKAR DATA ---
      const eveningAzkarData = [
        {
          id: "e_a1",
          name: "Ayat al-Kursi",
          arabic:
            "ÿßŸÑŸÑŸéŸëŸáŸè ŸÑŸéÿß ÿ•ŸêŸÑŸéŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß ŸáŸèŸàŸé ÿßŸÑŸíÿ≠ŸéŸäŸèŸë ÿßŸÑŸíŸÇŸéŸäŸèŸëŸàŸÖŸè €ö ŸÑŸéÿß ÿ™Ÿéÿ£ŸíÿÆŸèÿ∞ŸèŸáŸè ÿ≥ŸêŸÜŸéÿ©Ÿå ŸàŸéŸÑŸéÿß ŸÜŸéŸàŸíŸÖŸå €ö ŸÑŸéŸáŸè ŸÖŸéÿß ŸÅŸêŸä ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßŸàŸéÿßÿ™Ÿê ŸàŸéŸÖŸéÿß ŸÅŸêŸä ÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿê €ó ŸÖŸéŸÜŸí ÿ∞Ÿéÿß ÿßŸÑŸéŸëÿ∞ŸêŸä ŸäŸéÿ¥ŸíŸÅŸéÿπŸè ÿπŸêŸÜŸíÿØŸéŸáŸè ÿ•ŸêŸÑŸéŸëÿß ÿ®Ÿêÿ•Ÿêÿ∞ŸíŸÜŸêŸáŸê €ö ŸäŸéÿπŸíŸÑŸéŸÖŸè ŸÖŸéÿß ÿ®ŸéŸäŸíŸÜŸé ÿ£ŸéŸäŸíÿØŸêŸäŸáŸêŸÖŸí ŸàŸéŸÖŸéÿß ÿÆŸéŸÑŸíŸÅŸéŸáŸèŸÖŸí ŸàŸéŸÑŸéÿß ŸäŸèÿ≠ŸêŸäÿ∑ŸèŸàŸÜŸé ÿ®Ÿêÿ¥ŸéŸäŸíÿ°Ÿç ŸÖŸêŸÜŸí ÿπŸêŸÑŸíŸÖŸêŸáŸê ÿ•ŸêŸÑŸéŸëÿß ÿ®ŸêŸÖŸéÿß ÿ¥Ÿéÿßÿ°Ÿé €ö ŸàŸéÿ≥ŸêÿπŸé ŸÉŸèÿ±Ÿíÿ≥ŸêŸäŸèŸëŸáŸè ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßŸàŸéÿßÿ™Ÿê ŸàŸéÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿé €ñ ŸàŸéŸÑŸéÿß ŸäŸéÿ¶ŸèŸàÿØŸèŸáŸè ÿ≠ŸêŸÅŸíÿ∏ŸèŸáŸèŸÖŸéÿß €ö ŸàŸéŸáŸèŸàŸé ÿßŸÑŸíÿπŸéŸÑŸêŸäŸèŸë ÿßŸÑŸíÿπŸéÿ∏ŸêŸäŸÖŸè",
          translation:
            "AllƒÅhu lƒÅ ilƒÅha illƒÅ huwa al-·∏•ayyul-qayy≈´m... (Surah Al-Baqarah, 2:255)",
          note: "Recite 1 time. Protection for the entire night. (Sahih Muslim)",
          goal: 1,
        },
        {
          id: "e_a2",
          name: "Surah IkhlƒÅs, Falaq, NƒÅs",
          arabic:
            "ŸÇŸèŸÑŸí ŸáŸèŸàŸé ÿßŸÑŸÑŸéŸëŸáŸè ÿ£Ÿéÿ≠ŸéÿØŸå / ŸÇŸèŸÑŸí ÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®Ÿêÿ±Ÿéÿ®ŸêŸë ÿßŸÑŸíŸÅŸéŸÑŸéŸÇŸê / ŸÇŸèŸÑŸí ÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®Ÿêÿ±Ÿéÿ®ŸêŸë ÿßŸÑŸÜŸéŸëÿßÿ≥Ÿê",
          translation:
            "Recite the last three Surahs (Al-IkhlƒÅs, Al-Falaq, and An-NƒÅs)",
          note: "Recite 3 times each. Protection from all harm until morning. (Tirmidhi)",
          goal: 3,
        },
        {
          id: "e_a3",
          name: "Evening Declaration of Faith",
          arabic:
            "ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸêŸëŸä ÿ£ŸéŸÖŸíÿ≥ŸéŸäŸíÿ™Ÿè ÿ£Ÿèÿ¥ŸíŸáŸêÿØŸèŸÉŸéÿå ŸàŸéÿ£Ÿèÿ¥ŸíŸáŸêÿØŸè ÿ≠ŸéŸÖŸéŸÑŸéÿ©Ÿé ÿπŸéÿ±Ÿíÿ¥ŸêŸÉŸéÿå ŸàŸéŸÖŸéŸÑŸéÿßÿ¶ŸêŸÉŸéÿ™ŸéŸÉŸéÿå ŸàŸéÿ¨ŸéŸÖŸêŸäÿπŸé ÿÆŸéŸÑŸíŸÇŸêŸÉŸéÿå ÿ£ŸéŸÜŸéŸëŸÉŸé ÿ£ŸéŸÜŸíÿ™Ÿé ÿßŸÑŸÑŸéŸëŸáŸèÿå ŸÑŸéÿß ÿ•ŸêŸÑŸéŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß ÿ£ŸéŸÜŸíÿ™Ÿé ŸàŸéÿ≠ŸíÿØŸéŸÉŸé ŸÑŸéÿß ÿ¥Ÿéÿ±ŸêŸäŸÉŸé ŸÑŸéŸÉŸéÿå ŸàŸéÿ£ŸéŸÜŸéŸë ŸÖŸèÿ≠ŸéŸÖŸéŸëÿØŸãÿß ÿπŸéÿ®ŸíÿØŸèŸÉŸé ŸàŸéÿ±Ÿéÿ≥ŸèŸàŸÑŸèŸÉŸé",
          translation: "AllƒÅhumma innƒ´ amsaytu ush-hiduka... (4 times)",
          note: "Recite 4 times. Declaration of faith and protection. (Abu Dawood)",
          goal: 4,
        },
        {
          id: "e_a4",
          name: "Dua for protection from harm",
          arabic:
            "ÿ®Ÿêÿ≥ŸíŸÖŸê ÿßŸÑŸÑŸéŸëŸáŸê ÿßŸÑŸéŸëÿ∞ŸêŸä ŸÑŸéÿß ŸäŸéÿ∂Ÿèÿ±ŸèŸë ŸÖŸéÿπŸé ÿßÿ≥ŸíŸÖŸêŸáŸê ÿ¥ŸéŸäŸíÿ°Ÿå ŸÅŸêŸä ÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ∂Ÿê ŸàŸéŸÑŸéÿß ŸÅŸêŸä ÿßŸÑÿ≥ŸéŸëŸÖŸéÿßÿ°Ÿê ŸàŸéŸáŸèŸàŸé ÿßŸÑÿ≥ŸéŸëŸÖŸêŸäÿπŸè ÿßŸÑŸíÿπŸéŸÑŸêŸäŸÖŸè",
          translation: "BismillƒÅhilla·∫ñƒ´ lƒÅ ya·∏çurru ma øasmihi... (3 times)",
          note: "Recite 3 times. Nothing harmful will affect you. (Abu Dawood, Tirmidhi)",
          goal: 3,
        },
        {
          id: "e_a5",
          name: "Dua for protection from evil beings",
          arabic:
            "ÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®ŸêŸÉŸéŸÑŸêŸÖŸéÿßÿ™Ÿê ÿßŸÑŸÑŸéŸëŸáŸê ÿßŸÑÿ™ŸéŸëÿßŸÖŸéŸëÿßÿ™Ÿê ŸÖŸêŸÜŸí ÿ¥Ÿéÿ±ŸêŸë ŸÖŸéÿß ÿÆŸéŸÑŸéŸÇŸé",
          translation:
            "A ø≈´dhu bikalimƒÅtillƒÅhi-t-tƒÅmmƒÅti min sharri mƒÅ khalaq. (3 times)",
          note: "Recite 3 times. Protection from jinn, evil, and harm. (Muslim)",
          goal: 3,
        },
        {
          id: "e_a6",
          name: "Dua for protection & light",
          arabic:
            "ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸêŸëŸä ÿ£Ÿéÿ≥Ÿíÿ£ŸéŸÑŸèŸÉŸé ÿßŸÑŸíÿπŸéŸÅŸíŸàŸé ŸàŸéÿßŸÑŸíÿπŸéÿßŸÅŸêŸäŸéÿ©Ÿé ŸÅŸêŸä ÿßŸÑÿØŸèŸëŸÜŸíŸäŸéÿß ŸàŸéÿßŸÑÿ¢ÿÆŸêÿ±Ÿéÿ©Ÿêÿå ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ•ŸêŸÜŸêŸëŸä ÿ£Ÿéÿ≥Ÿíÿ£ŸéŸÑŸèŸÉŸé ÿßŸÑŸíÿπŸéŸÅŸíŸàŸé ŸàŸéÿßŸÑŸíÿπŸéÿßŸÅŸêŸäŸéÿ©Ÿé ŸÅŸêŸä ÿØŸêŸäŸÜŸêŸä ŸàŸéÿØŸèŸÜŸíŸäŸéÿßŸäŸéÿå ŸàŸéÿ£ŸéŸáŸíŸÑŸêŸä ŸàŸéŸÖŸéÿßŸÑŸêŸäÿå ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿßÿ≥Ÿíÿ™Ÿèÿ±Ÿí ÿπŸéŸàŸíÿ±Ÿéÿßÿ™ŸêŸäÿå ŸàŸéÿ¢ŸÖŸêŸÜŸí ÿ±ŸéŸàŸíÿπŸéÿßÿ™ŸêŸäÿå ŸàŸéÿßÿ≠ŸíŸÅŸéÿ∏ŸíŸÜŸêŸä ŸÖŸêŸÜŸí ÿ®ŸéŸäŸíŸÜŸê ŸäŸéÿØŸéŸäŸéŸë ŸàŸéŸÖŸêŸÜŸí ÿÆŸéŸÑŸíŸÅŸêŸäÿå ŸàŸéÿπŸéŸÜŸí ŸäŸéŸÖŸêŸäŸÜŸêŸä ŸàŸéÿπŸéŸÜŸí ÿ¥ŸêŸÖŸéÿßŸÑŸêŸäÿå ŸàŸéŸÖŸêŸÜŸí ŸÅŸéŸàŸíŸÇŸêŸäÿå ŸàŸéÿ£ŸéÿπŸèŸàÿ∞Ÿè ÿ®ŸêÿπŸéÿ∏ŸéŸÖŸéÿ™ŸêŸÉŸé ÿ£ŸéŸÜŸí ÿ£Ÿèÿ∫Ÿíÿ™ŸéÿßŸÑŸé ŸÖŸêŸÜŸí ÿ™Ÿéÿ≠Ÿíÿ™ŸêŸä",
          translation:
            "AllƒÅhumma innƒ´ as‚Äôalukal- øafwa wal- øƒÅfiyah... (Recite once)",
          note: "Recite 1 time. Protection, safety, and well-being in both worlds. (Abu Dawood, Ibn Majah)",
          goal: 1,
        },
        {
          id: "e_a7",
          name: "Tasbƒ´h, Ta·∏•mƒ´d, Takbƒ´r (Before Sleep)",
          arabic:
            "ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸé ÿßŸÑŸÑŸéŸëŸáŸê (Ÿ£Ÿ£) ÿå ÿßŸÑŸíÿ≠ŸéŸÖŸíÿØŸè ŸÑŸêŸÑŸéŸëŸáŸê (Ÿ£Ÿ£) ÿå ÿßŸÑŸÑŸéŸëŸáŸè ÿ£ŸéŸÉŸíÿ®Ÿéÿ±Ÿè (Ÿ£Ÿ§)",
          translation:
            "Sub·∏•ƒÅnallƒÅh (33), Al·∏•amdulillƒÅh (33), AllƒÅhu Akbar (34)",
          note: "Recite 100 total times before sleep. Brings peace, strength, and reward. (Bukhari, Muslim)",
          goal: 100,
        },
        {
          id: "e_a8",
          name: "Closing Du øƒÅ (Before Sleep)",
          arabic: "ÿßŸÑŸÑŸéŸëŸáŸèŸÖŸéŸë ÿ®Ÿêÿßÿ≥ŸíŸÖŸêŸÉŸé ÿ£Ÿéÿ≠ŸíŸäŸéÿß ŸàŸéÿ®Ÿêÿßÿ≥ŸíŸÖŸêŸÉŸé ÿ£ŸéŸÖŸèŸàÿ™Ÿè",
          translation: "AllƒÅhumma bismika a·∏•yƒÅ wa bismika am≈´t.",
          note: "Recite 1 time before sleep. ‚ÄúO Allah, in Your name I live and die.‚Äù (Bukhari)",
          goal: 1,
        },
      ];

      let prayerData = {};
      let missedPrayers = [];
      let istighfarCount = 0;
      let azkarCounters = {};
      let currentCalendarDate = new Date();
      let selectedCalendarDay = null; // Stores the Date object of the day being viewed/edited

      // --- Success Feedback Function (Updated for Vibration) ---
      function playSuccessFeedback() {
        // 1. Device Vibration (Only runs on supported mobile devices/browsers)
        if (navigator.vibrate) {
          // Vibrate pattern: 100ms on, 50ms off, 100ms on (double tap)
          navigator.vibrate([100, 50, 100]);
        }

        // 2. Sound Effect
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        if (!AudioContext) return;

        const audioCtx = new AudioContext();
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();

        // Configuration for a pleasing chime sound (A5 note)
        oscillator.type = "sine";
        oscillator.frequency.setValueAtTime(880, audioCtx.currentTime);

        // Volume and quick decay
        gainNode.gain.setValueAtTime(0, audioCtx.currentTime);
        gainNode.gain.linearRampToValueAtTime(0.5, audioCtx.currentTime + 0.05);
        gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.3);

        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        oscillator.start();
        oscillator.stop(audioCtx.currentTime + 0.3); // Play for 0.3 seconds
      }
      // ------------------------------------

      function loadData() {
        const data = {
          prayers: JSON.parse(
            localStorage.getItem("islamicTracker_prayers") || "{}"
          ),
          missed: JSON.parse(
            localStorage.getItem("islamicTracker_missed") || "[]"
          ),
          istighfar: parseInt(
            localStorage.getItem("islamicTracker_istighfar") || "0"
          ),
          azkar: JSON.parse(
            localStorage.getItem("islamicTracker_azkar") || "{}"
          ),
        };

        prayerData = data.prayers;
        missedPrayers = data.missed.sort(
          (a, b) => new Date(a.date) - new Date(b.date)
        ); // Sort by date
        istighfarCount = data.istighfar;
        azkarCounters = data.azkar;

        initializeDay();
        renderAll();
      }

      function initializeDay() {
        const today = new Date().toDateString();
        if (!prayerData[today]) {
          prayerData[today] = {};
          prayers.forEach((prayer) => {
            prayerData[today][prayer.name] = "pending";
          });
        }
        // Initialize Azkar counters for the day if they don't exist
        const azkarTodayKey = `azkar_${today}`;
        if (!azkarCounters[azkarTodayKey]) {
          azkarCounters[azkarTodayKey] = {};
          [...morningAzkarData, ...eveningAzkarData].forEach((azkar) => {
            azkarCounters[azkarTodayKey][azkar.id] = 0;
          });
        }
      }

      function saveData() {
        localStorage.setItem(
          "islamicTracker_prayers",
          JSON.stringify(prayerData)
        );
        localStorage.setItem(
          "islamicTracker_missed",
          JSON.stringify(missedPrayers)
        );
        localStorage.setItem(
          "islamicTracker_istighfar",
          istighfarCount.toString()
        );
        localStorage.setItem(
          "islamicTracker_azkar",
          JSON.stringify(azkarCounters)
        );
      }

      function showNotification(message) {
        const notification = document.getElementById("notification");
        notification.textContent = message;
        notification.classList.add("show");
        setTimeout(() => notification.classList.remove("show"), 3000);
      }

      function renderAll() {
        const today = new Date();
        document.getElementById(
          "currentDate"
        ).textContent = `Today: ${today.toLocaleDateString("en-US", {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
        })}`;
        renderPrayers();
        renderMissedPrayers();
        updateStats();
        updateIstighfarDisplay();
        renderAzkar();
      }

      function switchTab(tabName) {
        document
          .querySelectorAll(".tab-content")
          .forEach((tab) => tab.classList.remove("active"));
        document
          .querySelectorAll(".tab-button")
          .forEach((btn) => btn.classList.remove("active"));
        document.getElementById(tabName + "-tab").classList.add("active");

        // Find the button that was clicked or is associated with the tabName
        const targetButton = document.querySelector(
          `.tab-button[onclick*="switchTab('${tabName}')"]`
        );
        if (targetButton) {
          targetButton.classList.add("active");
        }

        if (tabName === "calendar") renderCalendar();
        else if (tabName === "qada") renderQadaArchive();
        else if (tabName === "azkar") renderAzkar();
        else if (tabName === "istighfar") updateIstighfarDisplay();
        else if (tabName === "salah") renderAll();
      }

      function updatePrayerStatus(prayerName, status) {
        const today = new Date().toDateString();
        const oldStatus = prayerData[today][prayerName];
        prayerData[today][prayerName] = status;

        // Remove from missed if it was missed and is now prayed or pending
        if (oldStatus === "missed") {
          missedPrayers = missedPrayers.filter(
            (mp) => !(mp.name === prayerName && mp.date === today)
          );
        }

        // Add to missed if status is 'missed' and it wasn't before
        if (status === "missed") {
          missedPrayers.push({
            name: prayerName,
            date: today,
            time: prayers.find((p) => p.name === prayerName).time,
            id: `${today}_${prayerName}`,
          });
          showNotification(
            `${prayerName} marked as missed. Don't forget to make it up later.`
          );
        } else if (status === "prayed") {
          showNotification(`${prayerName} completed - Barakallahu feek! ü§≤`);
        } else {
          showNotification(`${prayerName} status reset to pending.`);
        }

        saveData();
        renderAll();
      }

      function makeUpPrayer(id) {
        missedPrayers = missedPrayers.filter((mp) => mp.id !== id);
        showNotification(`Prayer made up - May Allah accept it! ü§≤`);
        saveData();
        renderAll();
        renderQadaArchive(); // Update archive if open
      }

      function renderPrayers() {
        const grid = document.getElementById("prayersGrid");
        const today = new Date().toDateString();
        // Ensure today's data is initialized before rendering
        if (!prayerData[today]) initializeDay();

        grid.innerHTML = prayers
          .map((prayer) => {
            const status = prayerData[today][prayer.name] || "pending";
            const missedCount = missedPrayers.filter(
              (mp) => mp.name === prayer.name
            ).length;
            const statusClass =
              status === "prayed"
                ? "prayed"
                : status === "missed"
                ? "missed"
                : "";

            return `
            <div class="prayer-card">
              <div class="prayer-header">
                <div class="prayer-name">${prayer.name}</div>
                <div class="prayer-time">${prayer.time}</div>
              </div>
              <div class="prayer-status">
                <button class="status-btn ${
                  status === "prayed" ? "prayed" : ""
                }"
                        onclick="updatePrayerStatus('${
                          prayer.name
                        }', 'prayed')">
                  ‚úÖ Prayed
                </button>
                <button class="status-btn ${
                  status === "missed" ? "missed" : ""
                }"
                        onclick="updatePrayerStatus('${
                          prayer.name
                        }', 'missed')">
                  ‚ùå Missed
                </button>
                 <button class="status-btn ${
                   status === "pending" ? "" : "pending-reset"
                 }"
                        onclick="updatePrayerStatus('${
                          prayer.name
                        }', 'pending')"
                        style="background: #ccc; color: #333;">
                  ‚ö™ Reset
                </button>
              </div>
              ${
                missedCount > 0
                  ? `<div class="missed-count">${missedCount} missed to make up</div>`
                  : ""
              }
            </div>
          `;
          })
          .join("");
      }

      function renderMissedPrayers() {
        // This renders the list on the TODAY'S SALAH tab
        const container = document.getElementById("missedPrayersList");
        const today = new Date().toDateString();

        // Filter out today's missed prayers
        const todayMissed = missedPrayers.filter((mp) => mp.date === today);

        if (todayMissed.length === 0) {
          container.innerHTML =
            '<p style="text-align: center; color: #666;">No missed prayers today - Alhamdulillah! üéâ</p>';
          return;
        }

        container.innerHTML = todayMissed
          .map(
            (prayer) => `
          <div class="missed-prayer-item">
            <div>
              <strong>${prayer.name}</strong><br>
              <small>${new Date(prayer.date).toLocaleDateString("en-US", {
                month: "short",
                day: "numeric",
              })} at ${prayer.time}</small>
            </div>
            <!-- Note: makeUpPrayer here applies to this specific day's instance -->
            <button class="make-up-btn" onclick="makeUpPrayer('${prayer.id}')">
              Make Up Prayer
            </button>
          </div>
        `
          )
          .join("");
      }

      function renderQadaArchive() {
        // This renders the list on the QADA ARCHIVE tab
        const container = document.getElementById("qadaArchiveList");
        const totalMissed = missedPrayers.length;
        document.getElementById("totalMissedArchive").textContent = totalMissed;

        if (totalMissed === 0) {
          container.innerHTML =
            '<p style="text-align: center; color: #666;">No missed prayers in the archive - Alhamdulillah! üéâ</p>';
          return;
        }

        // Group by date for better readability in the archive
        const groupedPrayers = missedPrayers.reduce((acc, mp) => {
          const date = new Date(mp.date).toLocaleDateString("en-US", {
            year: "numeric",
            month: "long",
            day: "numeric",
            weekday: "long",
          });
          if (!acc[date]) {
            acc[date] = [];
          }
          acc[date].push(mp);
          return acc;
        }, {});

        // Sort dates chronologically
        const sortedDates = Object.keys(groupedPrayers).sort(
          (a, b) => new Date(a) - new Date(b)
        );

        let html = "";
        sortedDates.forEach((date) => {
          const dayPrayers = groupedPrayers[date];
          html += `<h4 class="archive-date-header">üìÖ ${date} (${dayPrayers.length} prayers)</h4>`;

          dayPrayers.forEach((prayer) => {
            html += `
                    <div class="missed-prayer-item">
                        <div>
                            <strong>${prayer.name}</strong><br>
                            <small>Scheduled at ${prayer.time}</small>
                        </div>
                        <button class="make-up-btn" onclick="makeUpPrayer('${prayer.id}')">
                            Made Up (Remove)
                        </button>
                    </div>
                `;
          });
        });

        container.innerHTML = html;
      }

      function updateStats() {
        const today = new Date().toDateString();
        const todayPrayed = Object.values(prayerData[today] || {}).filter(
          (s) => s === "prayed"
        ).length;
        const totalMissed = missedPrayers.length;

        document.getElementById("todayPrayed").textContent = todayPrayed;
        document.getElementById("totalMissed").textContent = totalMissed;

        const weekStart = new Date();
        weekStart.setDate(weekStart.getDate() - weekStart.getDay());
        let weeklyPrayed = 0;
        let weeklyTotal = 0;
        const todayDate = new Date();

        for (let i = 0; i < 7; i++) {
          const date = new Date(weekStart);
          date.setDate(weekStart.getDate() + i);
          const dateStr = date.toDateString();

          // Only count up to and including today
          if (date <= todayDate) {
            if (prayerData[dateStr]) {
              const dayPrayed = Object.values(prayerData[dateStr]).filter(
                (s) => s === "prayed"
              ).length;
              weeklyPrayed += dayPrayed;
              weeklyTotal += 5;
            } else {
              // If a day is missing data, assume 0 prayed for a realistic weekly %
              weeklyTotal += 5;
            }
          }
        }

        const weeklyPercentage =
          weeklyTotal > 0 ? Math.round((weeklyPrayed / weeklyTotal) * 100) : 0;
        document.getElementById(
          "weeklyPercentage"
        ).textContent = `${weeklyPercentage}%`;
      }

      function resetDay() {
        const today = new Date().toDateString();
        // Remove today's entries from missedPrayers
        missedPrayers = missedPrayers.filter((mp) => mp.date !== today);

        // Reset today's prayerData
        prayerData[today] = {};
        prayers.forEach((prayer) => {
          prayerData[today][prayer.name] = "pending";
        });

        // Reset today's Istighfar
        istighfarCount = 0;

        // Reset today's Azkar counters
        const azkarTodayKey = `azkar_${today}`;
        azkarCounters[azkarTodayKey] = {};
        [...morningAzkarData, ...eveningAzkarData].forEach((azkar) => {
          azkarCounters[azkarTodayKey][azkar.id] = 0;
        });

        saveData();
        renderAll();
        showNotification(
          "Today's practices (prayers, Istighfar, and Azkar) have been reset."
        );
      }

      /* --- Calendar Functions --- */

      function renderCalendar() {
        const monthNames = [
          "January",
          "February",
          "March",
          "April",
          "May",
          "June",
          "July",
          "August",
          "September",
          "October",
          "November",
          "December",
        ];
        const year = currentCalendarDate.getFullYear();
        const month = currentCalendarDate.getMonth();
        const today = new Date().toDateString();

        document.getElementById(
          "currentMonth"
        ).textContent = `${monthNames[month]} ${year}`;
        const calendarEl = document.getElementById("calendar");
        calendarEl.innerHTML = "";

        const firstDayOfMonth = new Date(year, month, 1);
        const lastDayOfMonth = new Date(year, month + 1, 0);
        const startDay = firstDayOfMonth.getDay(); // 0 for Sunday, 6 for Saturday

        // Previous month's days to fill the grid
        for (let i = 0; i < startDay; i++) {
          const dayEl = document.createElement("div");
          dayEl.classList.add("calendar-day", "other-month");
          calendarEl.appendChild(dayEl);
        }

        // Current month's days
        for (let day = 1; day <= lastDayOfMonth.getDate(); day++) {
          const date = new Date(year, month, day);
          const dateStr = date.toDateString();
          const dayEl = document.createElement("div");
          dayEl.classList.add("calendar-day");
          dayEl.innerHTML = `<div class="day-number">${day}</div>`;
          dayEl.dataset.date = dateStr;
          dayEl.onclick = () => openDayModal(date);

          // Check for missed prayers on this day
          const missedOnDay = missedPrayers.filter(
            (mp) => mp.date === dateStr
          ).length;
          if (missedOnDay > 0) {
            dayEl.classList.add("has-missed");
            dayEl.innerHTML += `<div class="missed-indicator">‚ùå ${missedOnDay}</div>`;
          }

          // Highlight today
          if (dateStr === today) {
            dayEl.classList.add("today");
          }
          // Disable future dates
          if (date > new Date()) {
            dayEl.style.pointerEvents = "none";
            dayEl.style.backgroundColor = "#f0f0f0";
            dayEl.style.opacity = "0.5";
          }

          calendarEl.appendChild(dayEl);
        }
      }

      function changeMonth(direction) {
        currentCalendarDate.setMonth(
          currentCalendarDate.getMonth() + direction
        );
        renderCalendar();
      }

      /* --- Modal Functions --- */

      function openDayModal(date) {
        const dateStr = date.toDateString();
        selectedCalendarDay = date; // Store the date

        // Ensure data for the selected day exists before opening the modal
        if (!prayerData[dateStr]) {
          prayerData[dateStr] = {};
          prayers.forEach((prayer) => {
            prayerData[dateStr][prayer.name] = "pending";
          });
        }

        document.getElementById("modalDate").textContent =
          date.toLocaleDateString("en-US", {
            weekday: "long",
            year: "numeric",
            month: "long",
            day: "numeric",
          });
        document.getElementById("dayModal").style.display = "block";

        const modalPrayersEl = document.getElementById("modalPrayers");
        modalPrayersEl.innerHTML = "";

        // The modal allows you to see the status of all five prayers (Fajr, Dhuhr, Asr, Maghrib, Isha)
        prayers.forEach((prayer) => {
          const currentStatus = prayerData[dateStr][prayer.name] || "pending";
          const selectId = `status-${prayer.name}`;

          modalPrayersEl.innerHTML += `
            <div class="prayer-check-item">
              <strong>${prayer.name}</strong>
              <select id="${selectId}">
                <option value="prayed" ${
                  currentStatus === "prayed" ? "selected" : ""
                }>‚úÖ Prayed</option>
                <option value="missed" ${
                  currentStatus === "missed" ? "selected" : ""
                }>‚ùå Missed</option>
                <option value="pending" ${
                  currentStatus === "pending" ? "selected" : ""
                }>‚ö™ Pending/Not Tracked</option>
              </select>
            </div>
          `;
        });
      }

      function closeDayModal() {
        document.getElementById("dayModal").style.display = "none";
        selectedCalendarDay = null;
      }

      function saveDayPrayers() {
        if (!selectedCalendarDay) return;

        const dateStr = selectedCalendarDay.toDateString();

        prayers.forEach((prayer) => {
          const selectId = `status-${prayer.name}`;
          const selectEl = document.getElementById(selectId);
          if (selectEl) {
            const newStatus = selectEl.value;
            const oldStatus = prayerData[dateStr][prayer.name];
            prayerData[dateStr][prayer.name] = newStatus;

            const prayerId = `${dateStr}_${prayer.name}`;

            // Remove from missed if it was missed and is now prayed or pending
            if (oldStatus === "missed") {
              missedPrayers = missedPrayers.filter((mp) => mp.id !== prayerId);
            }

            // Add to missed if status is 'missed' and it wasn't before
            if (newStatus === "missed") {
              // Prevent duplicates if already added from the 'salah' tab
              if (!missedPrayers.some((mp) => mp.id === prayerId)) {
                missedPrayers.push({
                  name: prayer.name,
                  date: dateStr,
                  time: prayer.time,
                  id: prayerId,
                });
              }
            }
          }
        });

        saveData();
        closeDayModal();
        renderAll();
        renderCalendar(); // Refresh calendar to show missed indicators
        showNotification(`Prayer data saved for ${dateStr}!`);
      }

      /* --- Istighfar Functions --- */

      function updateIstighfarDisplay() {
        document.getElementById("istighfarCount").textContent = istighfarCount;
      }

      function incrementIstighfar() {
        istighfarCount++;
        updateIstighfarDisplay();
        saveData();
        if (istighfarCount === 100) {
          showNotification("Masha'Allah! You reached your Istighfar goal! üéâ");
          playSuccessFeedback(); // Play success feedback
        }
      }

      function resetIstighfar() {
        istighfarCount = 0;
        updateIstighfarDisplay();
        saveData();
        showNotification("Istighfar count reset to 0.");
      }

      /* --- Azkar Functions --- */

      function renderAzkar() {
        const today = new Date().toDateString();
        const azkarTodayKey = `azkar_${today}`;

        const renderAzkarSection = (data, containerId) => {
          const container = document.getElementById(containerId);
          container.innerHTML = data
            .map((azkar) => {
              const currentCount =
                (azkarCounters[azkarTodayKey] &&
                  azkarCounters[azkarTodayKey][azkar.id]) ||
                0;
              const progressClass = currentCount >= azkar.goal ? "prayed" : "";
              const buttonText =
                currentCount >= azkar.goal
                  ? "Goal Reached! (Reset)"
                  : "Count +1";

              return `
                    <div class="azkar-card ${progressClass}">
                        <div class="azkar-title">${azkar.name}</div>
                        <div class="azkar-note">${azkar.note}</div>
                        <div class="azkar-text">${azkar.arabic}</div>
                        <div class="azkar-translation">${azkar.translation}</div>
                        <div class="azkar-counter">
                            <button class="counter-btn ${progressClass}" onclick="incrementAzkar('${azkar.id}', ${azkar.goal})">
                                ${buttonText}
                            </button>
                            <div class="counter-display" id="azkarCount-${azkar.id}">
                                ${currentCount} / ${azkar.goal}
                            </div>
                        </div>
                    </div>
                `;
            })
            .join("");
        };

        renderAzkarSection(morningAzkarData, "morningAzkar");
        renderAzkarSection(eveningAzkarData, "eveningAzkar");
      }

      function incrementAzkar(azkarId, goal) {
        const today = new Date().toDateString();
        const azkarTodayKey = `azkar_${today}`;

        if (!azkarCounters[azkarTodayKey]) initializeDay(); // Initialize if not present

        let currentCount = azkarCounters[azkarTodayKey][azkarId] || 0;

        if (currentCount >= goal) {
          // If goal is reached, reset on click
          azkarCounters[azkarTodayKey][azkarId] = 0;
          showNotification("Azkar count reset!");
        } else {
          // Increment
          azkarCounters[azkarTodayKey][azkarId] = currentCount + 1;
          if (currentCount + 1 === goal) {
            showNotification("Masha'Allah! Azkar goal reached! üéâ");
            playSuccessFeedback(); // Play success feedback
          }
        }

        saveData();
        renderAzkar(); // Re-render the azkar section to update the counter and button text
      }

      // Initial load and render
      window.onload = loadData;

      // Ensure modal closes when clicking outside of it
      window.onclick = function (event) {
        const dayModal = document.getElementById("dayModal");
        if (event.target == dayModal) {
          closeDayModal();
        }
      };
    </script>
  </body>
</html>
